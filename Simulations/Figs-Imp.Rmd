---
author: "Hector Roux de BÃ©zieux"
date: '`r format(Sys.time(), "%d %B , %Y")`'
title: 'Results on simulation data'
output:
  html_document:
    toc: true
    toc_float: TRUE
    toc_depth: 2
    number_sections: true
    code_download: TRUE
---

```{r load packages, include=F}
library(knitr)
opts_chunk$set(
  fig.pos = "!h", out.extra = "", warning = F, message = F,
  fig.align = "center", echo = F
)
libs <- c("here", "dplyr", "ggplot2", "tidyr", "stringr", "readr", "cowplot",
          "mclust", "RColorBrewer", "purrr", "Dune", "pracma", "purrr",
          "DailyHRB", "patchwork")
suppressMessages(
  suppressWarnings(sapply(libs, require, character.only = TRUE))
)
rm(libs)
```

# Input vs Output 

```{r}
dfs <- list(
  read.csv(here("Simulations", "Data", "Sizes.csv")) %>%
    select(-X, -Name),
  read.csv(here("Simulations", "Data", "Param.csv")) %>%
  select(-X, -Name),
  read.csv(here("Simulations", "Data", "Ns.csv")) %>%
  select(-X, -Name)
)
dfs <- lapply(dfs, function(df) {
  df <- df %>%
    select(-n_clus) %>%
    filter(level %in% c(0, 100)) %>%
    mutate(level = if_else(level == 0, "Init", "Final")) %>%
    pivot_wider(names_from = "level", values_from  = "Value") %>%
    select(Init, Final)
}) %>%
  bind_rows()

ggplot(dfs, aes(x = Init, y = Final - Init)) +
  geom_point() +
  labs(x = "Improvement") +
  scale_x_continuous(limits = c(0, 1)) +
  theme_bw()
```